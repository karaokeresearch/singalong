<html>
	<head>
		<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1, maximum-scale=1">
		<link rel="stylesheet" href="assets/style.css">
		<title>Strum test</title>
	</head>
	<body style="padding: 0; margin: 0;">

		<div id="hit" style="font-size: 0; background: #42d692; padding: 0px;">
			<span id="target" style="background: #9fe1e7; display: inline-block; width: 20%; height: 75%;"></span>
			<span id="target" style="background: #222222; display: inline-block; width: 20%; height: 75%;"></span>
			<span id="target" style="background: #9fe1e7; display: inline-block; width: 20%; height: 75%;"></span>
			<span id="target" style="background: #222222; display: inline-block; width: 20%; height: 75%;"></span>
			<span id="target" style="background: #9fe1e7; display: inline-block; width: 20%; height: 75%;"></span>
		</div>
		<p></p>
		<div style="font-size: 2em; text-align:center;">Use your finger or mouse to strum across the blue and black squares above.</div>
		<script src="hammer.js"></script>
		<script type="text/javascript" src="howler.js" ></script>
		<script type="text/javascript" src="teoria.js" ></script>

		<script>
			var xPrev=0;


			var el = document.querySelector("#hit");


			var mc = new Hammer(el);
			mc.on("panmove", logGesture);
			mc.on("tap", playNote);

			//mc.on("swipe pan panstart panmove panend pancancel multipan press pressup pinch rotate tap doubletap",

				var stringIDs=[];
				var chordNotes=[];
      
      var changeChord = function (whichChord){
				var tempChordNotes =[];
				var chord=teoria.chord(whichChord);
				for (i=0; i< chord.notes().length; i++) {
					tempChordNotes.push((chord.notes()[i].key()+4)%24);
				}
				for (i=0; i< chord.notes().length; i++) {
					tempChordNotes.push(((chord.notes()[i].key()+16)%24));
				}
				tempChordNotes.sort(function(a, b){return a-b});
				return tempChordNotes;
			}
			
			chordNotes=changeChord('G');
      
			
			noteLength=4000;
			var sound = new Howl({
				urls: ['strumAscendAmono.ogg' ],
				volume: 0.65,
				sprite: {
					1 : [ 0*noteLength, 3800],
					2 : [ 1*noteLength, 3800],
					3 : [ 2*noteLength, 3800],
					4 : [ 3*noteLength, 3800],
					5 : [ 4*noteLength, 3800],
					6 : [ 5*noteLength, 3800],
					7 : [ 6*noteLength, 3800],
					8 : [ 7*noteLength, 3800],
					9 : [ 8*noteLength, 3800],
					10 : [ 9*noteLength, 3800],
					11 : [10*noteLength, 3800],
					12 : [11*noteLength, 3800],
					13 : [12*noteLength, 3800],
					14 : [13*noteLength, 3800],
					15 : [14*noteLength, 3800],
					16 : [15*noteLength, 3800],
					17 : [16*noteLength, 3800],
					18 : [17*noteLength, 3800],
					19 : [18*noteLength, 3800],
					20 : [19*noteLength, 3800],
					21 : [20*noteLength, 3800],
					22 : [21*noteLength, 3800],
					23 : [22*noteLength, 3800],
					24 : [23*noteLength, 3800]
				}
			});
			function playNote(ev) {
				//sound.play(chordNotes[1]);
			}

			function logGesture(ev) {


				for (j = 1; j < 5; j++) {
					stringPos=j*(window.innerWidth/5);

					if((ev.center.x >stringPos && xPrev<stringPos) || (ev.center.x <stringPos && xPrev>stringPos)) {
						sound.play(chordNotes[j-1]+1,function(soundID){
							stringIDs[j-1]=soundID;
						});
					}

				}


				xPrev=ev.center.x;
			}

		</script>
	</body>
</html>
